#!/usr/bin/env php
<?php
/**
 * Created by PhpStorm.
 * User: Maps_red
 * Date: 06/02/2017
 * Time: 19:06
 */

if (basename(getcwd()) !== "Luryo") {
    exit("Error ! Please run this script from the base of the project\n");
}
$empty = true;
$commands = [
    "--full" => [
        "git pull",
        "php bin/console doctrine:schema:update --dump-sql",
        "php bin/console doctrine:schema:update --force",
        "php composer.phar install",
        "php bin/console cache:clear --env=prod",
        "php bin/console cache:clear --env=dev",
        "php bin/console assetic:dump --env=prod",
        "php bin/console assetic:dump --env=dev",
    ],
];

foreach ($commands as $flag => $command) {
    if (in_array($flag, $argv)) {
        $empty = false;
        if (is_array($command)) {
            foreach ($command as $cmd) {
                echo shell_exec($cmd);
            }
        } else {
            echo shell_exec($command);
        }
    }
}

if ($empty) {
    $flags = array_keys($commands);
    echo "List of flags : ".implode(", ", $flags);
}